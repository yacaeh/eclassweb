<!-- Demo version: 2018.12.11 -->

<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <link rel="stylesheet" href="/dashboard/css/classroom.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title id="class-title">E클래스 000 반 00 수업</title>
    <meta name="description"
        content="WebRTC Dashboard including support for canvas drawing, canvas data syncing, video conferencing, screen sharing and video conferencing. Including chat and file sharing.">

    <link rel="shortcut icon" href="/dashboard/logo.png">
    
    <script src="/dashboard/js/jquery.min.js"></script>
    <link href="/dashboard/css/bootstrap.min.css" rel="stylesheet">
    <script src="/node_modules/webrtc-adapter/out/adapter.js"></script>
    <script src="/dist/RTCMultiConnection.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/node_modules/fbr/FileBufferReader.js"></script>
    
    <script src="/node_modules/canvas-designer/dev/webrtc-handler.js"></script>
    <script src="/node_modules/canvas-designer/canvas-designer-widget.js"></script>
    <link rel="stylesheet" type="text/css" href="/dashboard/css/emojionearea.min.css">
    <script src="/dashboard/js/emojionearea.min.js"></script>
    <!-- <script src="/node_modules/multistreamsmixer/MultiStreamsMixer.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.4.456/build/pdf.min.js"></script>
    <script defer src="/dashboard/js/classroom.js"></script>

<body>

    <header id="header">
        <img id="icon_exit">
        <img id="top_logo"> 

        <span id="who-am-i"></span>
        <span id="my-name"></span>
        <span id="session-id"></span>

        <div class="icons">
            <img id="btn-attach-file" src="https://www.webrtc-experiment.com/images/share-screen.png" title="Share Your Screen">
            <img id="top_all_controll">
            <img id="top_load_book">
            <img id="top_test">
            <img id="top_alert">
            <img id="top_share_screen"> 
            <img id="top_3d">
            <img id="top_share_video">
            <img id="top_record_video">
            <span class="time">
                <span id="current-day">0000-00-00</span>
                <span id="current-time">00:00:00</span>
            </span>
        </div>

    </header>

    <article id="article">
        <div id="widget-container"></div>
        <video id="screen-viewer" controls playsinline autoplay></video>
        <div class="lwindow">

            <div class="for_teacher" style="display: none;">
                <span id="view_student" class='view_type'>Student</span>
                <span id="vidw_cam" class='view_type'>Cam & File</span>
                <span id="view_result" class='view_type'>Result</span>
                <span class="nos">
                    <span id="nos"></span>
                    <img src="/dashboard/img/man_icon.png">
                </span>


                <div id="student_list"></div>
            </div>



            <!-- View Student  -->


            <!-- View Cam -->
            <video id="main-video" controls playsinline autoplay></video>

            <!-- View Result -->

            <div class="conversation-panel" >
                <div id="conversation-panel"></div>
                <div id="key-press">
                    <span id="key-press-span"></span>
                    <img src="https://www.webrtc-experiment.com/images/key-press.gif" id="key-press-image">
                </div>
                <textarea id="txt-chat-message"></textarea>
                <button class="btn btn-primary" id="btn-chat-message">SEND MESSAGE</button>
            </div>

            <canvas id="temp-stream-canvas"></canvas>
        </div>
    </article>

    <script src="//mozilla.github.io/pdf.js/build/pdf.js"></script>
    <style>
    #canvas-controller{
      position:relative; 
      z-index: 0;

    }
    #the-canvas {
      border: 1px solid black;
      direction: ltr;
      position:relative; 
      z-index: 0;
    }
    </style>
    <h1>PDF.js Previous/Next example</h1>
    
    <div id="canvas-controller">
      <button id="prev">Previous</button>
      <button id="next">Next</button>
      &nbsp; &nbsp;
      <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>
      <button id="close-pdf">close</button>
    </div>
        
    <script>
    // If absolute URL from the remote server is provided, configure the CORS
    // header on that server.
    var url = 'test.pdf';
    
    // Loaded via <script> tag, create shortcut to access PDF.js exports.
    var pdfjsLib = window['pdfjs-dist/build/pdf'];
    
    // The workerSrc property shall be specified.
    pdfjsLib.GlobalWorkerOptions.workerSrc = '//mozilla.github.io/pdf.js/build/pdf.worker.js';
    
    var pdfDoc = null,
        pageNum = 1,
        pageRendering = false,
        pageNumPending = null,
        scale = 0.8,
        canvas = document.getElementById('main-canvas'),
        ctx = canvas.getContext('2d');
    
    /**
     * Get page info from document, resize canvas accordingly, and render page.
     * @param num Page number.
     */
    function renderPage(num) {
      pageRendering = true;
      // Using promise to fetch the page
      pdfDoc.getPage(num).then(function(page) {
        var viewport = page.getViewport({scale: scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;
    
        // Render PDF page into canvas context
        var renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        var renderTask = page.render(renderContext);
    
        // Wait for rendering to finish
        renderTask.promise.then(function() {
          pageRendering = false;
          if (pageNumPending !== null) {
            // New page rendering is pending
            renderPage(pageNumPending);
            pageNumPending = null;
          }
          document.getElementById('main-canvas').style.zIndex = +1;

        });
      });
    
      // Update page counters
      document.getElementById('page_num').textContent = num;
    }
    
    /**
     * If another page rendering in progress, waits until the rendering is
     * finised. Otherwise, executes rendering immediately.
     */
    function queueRenderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    }
    
    /**
     * Displays previous page.
     */
    function onPrevPage() {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    }
    document.getElementById('prev').addEventListener('click', onPrevPage);
    
    /**
     * Displays next page.
     */
    function onNextPage() {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    }
    document.getElementById('next').addEventListener('click', onNextPage);
    
    function closePDF() {
      console.log("close!");
      console.log(pdfDoc);
      pdfjsLib.destroy();
      document.removeAttribute.getElementById('the-canvas')
    }
    document.getElementById('close-pdf').addEventListener('click', closePDF);

    /**
     * Asynchronously downloads PDF.
     */
    pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
      pdfDoc = pdfDoc_;
      document.getElementById('page_count').textContent = pdfDoc.numPages;
    
      // Initial/first page rendering
      renderPage(pageNum);
    });    
    </script>
</body>


</html>